---
title: "Sandbox"
output: html_document
---

Things to alter
-color of text boxes (geom_rect --> size dependent on #letters) - one color for the text box color (gradient hex) - text inside gonna be white
-what the text says - 3 different textboxes (filename)
-background/input image?
-effect on the image??


```{r}
library(tidyverse)
library(cowplot)
library(stringr)
library(magick)
library(rasterImage)
```

```{r}
# #read image and convert to grayscale
# #this will have to be changed when combining to shiny
# img <- image_read("/home/guest/R/project-2-viz_biz/eli-shiny/img/kruger.png") %>%
#   image_convert(colorspace = "gray")
```

```{r}
library(jpeg)
library(png)
my_image <- readPNG("/home/guest/R/project-2-viz_biz/eli-shiny/img/kruger.png")
 

height <- dim(my_image)[1]
width <- dim(my_image)[2]


dev.new(width = width, height = height, unit = "px")
plot(x= width, y = height, xlim=c(0,width), ylim=c(0,height))
```


height <- dim(my_image)[1]
width <- dim(my_image)[2]

# Set up a plot area with no plot
plot(1:50, type='n', main="", xlab="x", ylab="y", asp = 1)
 
# Get the plot information so the image will fill the plot box, and draw it
lim <- par()
rasterImage(my_image, 
            xleft=1, xright=2, 
            ybottom=1.3, ytop=1.7)
grid()
 
#Add your plot !
lines(
  x=c(1, 1.2, 1.4, 1.6, 1.8, 2.0), 
  y=c(1, 1.3, 1.7, 1.6, 1.7, 1.0), 
  type="b", lwd=5, col="black")


```



```{r}
# Get dimensions
img_w <- image_info(img)$width
img_h <- image_info(img)$height
img_ratio <- img_w / img_h

# Resize the longest dimension to 80 pixels
if (img_w >= img_h) {
  img <- image_resize(img, "80")
} else {
  img <- image_resize(img, ("x80"))
}
```

```{r}
plot(1:80,ty="n")
rasterImage(img,0,0,63,80)
```






```{r}
img_array <- drop(as.integer(img[[1]]))
rownames(img_array) <- 1:nrow(img_array)
colnames(img_array) <- 1:ncol(img_array)

# Create data frame from array and rename columns
img_df <- as.data.frame.table(img_array) %>% 
  `colnames<-`(c("y", "x", "b")) %>% 
  mutate(
		across(everything(), as.numeric),
		# map b (0-255) to bf (1-0), so that "brighter" values become smaller numbers
		bf = 1 - b / 255,
		# and then map to i (1-10) to use with the character ramp
		i = round(bf * 10),
		# replace 0 with 1
		i = if_else(i == 0, 1, i)
		) %>%
  rowwise() %>%
  arrange(y, x)

```









```{r}
ggplot(img_df) +
  # size of text is calculated from image height and is approximate
	geom_text(aes(x, y, label = c), family = "Courier Bold", size = max(img_df$y)/20) +
	scale_y_reverse() +
	coord_fixed() +
	theme_void()
```



