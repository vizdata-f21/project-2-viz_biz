---
title: "Sandbox"
output: html_document
---

Things to alter
-color of text boxes (geom_rect --> size dependent on #letters) - one color for the text box color (gradient hex) - text inside gonna be white
-what the text says - 3 different textboxes (filename)
-background/input image?
-effect on the image??


```{r packages}
library(tidyverse)
library(cowplot)
library(stringr)
library(magick)
library(rasterImage)
library(jpeg)
library(png)
```

```{r inputs}
path <- "/home/guest/R/project-2-viz_biz/eli-shiny/img/kruger.png"

#text
top <- "Your body"
middle <- "is a fantastically amazing"
bottom <- "battleground"

text_size <- 5
rect_color <- "red"
text_color <- "white"
font <- "times"
emphasis <- "bold"
border_size <- 3
```

```{r dimensions}
if (substring(path, nchar(path)-3, nchar(path)) == "jpeg" |
    substring(path, nchar(path)-3, nchar(path)) == "jpg") {
  my_image <- readJPEG(path)
} else {
 my_image <- readPNG(path)
}



height <- dim(my_image)[1]
width <- dim(my_image)[2]

plot_size <- tribble(
  ~x, ~y,
  0, 0, 
  width, height)

if (height>width) {
size = width/500
} else {
size  = height/500
}
```

```{r labels}
label_maker <- tribble(
  ~text, ~x, ~y,
  top, width/2, height-30*size,
  middle, width/2, height/2,
  bottom, width/2, 30*size)
```

```{r}

```



```{r plotting}
ggplot() +
  geom_point(data = plot_size, aes(x = x, y = y), alpha = 0) +
 draw_image(frink, x = 0, y=0, width = width,  height = height) +
  geom_label(data = label_maker, 
             mapping = aes(x = x, 
                           y = y, 
                           label = text),
             size = text_size,
             fill = rect_color,
             color = text_color,
             family = font,
             fontface = emphasis,
             label.size = 0,
             label.r = unit(0, "lines")) +
  geom_rect(aes(xmin  = 0 , xmax = width ,
            ymin = 0 , ymax = height ),
            color = rect_color,
            size = border_size,
            fill = NA) +
  coord_equal() +
  theme_void()

```
