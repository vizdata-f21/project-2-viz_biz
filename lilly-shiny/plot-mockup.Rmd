---
title: "plot-mockup"
author: "Lillian Clark"
date: "11/16/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggforce)
library(ggnewscale)
library(magrittr)
```

```{r}
circles <- tribble(~x, ~y, ~shape, ~color, ~radius, ~layer_order, ~color_category,
                30, 69, "fill", "#583B76", 6, 1, "purple",
                30, 69, "fill", "#0F0F11", 12, 2, "black",
                30, 69, "fill", "#CA7A7C", 14, 4, "pink",
                30, 69, "fill", "#CB6A5A", 15, 5, "red",
                39, 57, "fill", "#A42117", 5, 3, "red",
                39.5, 56.5, "fill", "#E2BF50", 7.5, 6, "yellow",
                27, 25, "fill", "#CCB644", 4.5, 1, "yellow",
                27, 25, "stroke", "#0C0E18", 4.7, 2, "black",
                27, 25, "fill", "#6E93B6", 6, 3, "blue",
                27, 25, "fill", "#9E98B2", 7.3, 4, "purple",
                62, 11.5, "fill", "#2F5581", 3.2, 1, "blue",
                62.5, 11, "fill", "#D4A590", 4.5, 2, "orange",
                62.5, 11, "fill", "#CEBF4A", 5.5, 3, "yellow",
                121, 14, "fill", "#73776D", 5.5, 1, "grey",
                106.5, 20, "fill", "#7F67A8", 3.5, 1, "purple",
                75.5, 60, "fill", "#F7F4F5", 2.2, 1, "white",
                75.5, 60, "stroke", "#701A23", 2.5, 2, "red",
                75.5, 60, "stroke", "#010601", 3, 3, "black",
                75.5, 60, "fill", "#F5F0F3", 4.3, 4, "white",
                75.5, 60, "stroke", "#A19E9B", 4.4, 5, "black",
                75.5, 69, "fill", "#BB3247", 1, 1, "red",
                75.5, 69, "stroke", "#202222", 1.2, 2, "black",
                82, 78, "fill", "#80808C", 1.5, 1, "grey",
                88, 65, "fill", "#FFFEFD", 1.5, 1, "white",
                88, 65, "stroke", "#666561", 1.7, 2, "grey",
                88, 65, "fill", "#B3BBB2", 0.8, 3, "green",
                96, 73.5, "fill", "#2A2981", 1.3, 1, "blue",
                96, 73.5, "fill", "#CBC5C0", 1.8, 2, "grey",
                96, 73.5, "stroke", "#2E2A28", 2, 3, "black",
                113, 49, "fill", "#375A99", 4, 1, "blue",
                124, 63.5, "fill", "#A88698", 2.5, 1, "purple",
                124.3, 63.2, "fill", "#C64536", 2.9, 2, "red",
                124, 70.5, "fill", "#7697CF", 2.2, 1, "blue",
                124, 70.5, "fill", "#DDCC77", 2.8, 2, "yellow",
                132.5, 68.5, "fill", "#F2EDF1", 2, 1, "white",
                132.5, 68.5, "stroke", "#0C0908", 2.2, 2, "black",
                #this one is special and needs to actually be stroke
                109, 68, "stroke", "#080A08", 4.2, 3, "black",
                111, 68, "fill", "#95B29C", 3.5, 1, "green",
                109, 68, "fill", "#C7AC60", 4, 2, "yellow",
                97, 46, "fill", "#050405", 0.5, 1, "black",
                96.5, 46, "fill", "#E7DEDC", 3, 2, "white",
                96.5, 46, "fill", "#33388F", 3.7, 3, "blue",
                96.5, 46, "stroke", "#170E01", 3.9, 4, "black")

circles %<>%
  mutate(
    color_order = row_number(),
    color = fct_reorder(color, color_order))

circle_cols <- as.character(circles$color)

circle_1 <- circles %>%
  filter(layer_order == 1) %>%
  mutate(
    color_order = row_number(),
    color = fct_reorder(color, color_order))

cols1 <- as.character(circle_1$color)

circle_2 <- circles %>%
  filter(layer_order == 2) %>%
  mutate(
    color_order = row_number(),
    color = fct_reorder(color, color_order))

cols2 <- as.character(circle_2$color)

circle_3 <- circles %>%
  filter(layer_order == 3) %>%
  mutate(
    color_order = row_number(),
    color = fct_reorder(color, color_order))

cols3 <- as.character(circle_3$color)

circle_4 <- circles %>%
  filter(layer_order == 4) %>%
  mutate(
    color_order = row_number(),
    color = fct_reorder(color, color_order))

cols4 <- as.character(circle_4$color)

circle_5 <- circles %>%
  filter(layer_order == 5) %>%
  mutate(
    color_order = row_number(),
    color = fct_reorder(color, color_order))

cols5 <- as.character(circle_5$color)

circle_6 <- circles %>%
  filter(layer_order == 6) %>%
  mutate(
    color_order = row_number(),
    color = fct_reorder(color, color_order))

cols6 <- as.character(circle_6$color)

ggplot() +
  #geom_circle(data = circles, aes(x0 = x, y0 = y, r = radius, color = color)) +
  geom_circle(data = circle_6, aes(x0 = x, y0 = y, r = radius, fill = color, color = color)) +
  scale_fill_manual(values = cols6) +
  scale_color_manual(values = cols6) +
  new_scale_fill() +
  new_scale_color() +
  geom_circle(data = circle_5, aes(x0 = x, y0 = y, r = radius, fill = color, color = color)) +
  scale_fill_manual(values = cols5) +
  scale_color_manual(values = cols5) +
  new_scale_fill() +
  new_scale_color() +
  geom_circle(data = circle_4, aes(x0 = x, y0 = y, r = radius, fill = color, color = color)) +
  scale_fill_manual(values = cols4) +
  scale_color_manual(values = cols4) +
  new_scale_fill() +
  new_scale_color() +
  geom_circle(data = circle_3, aes(x0 = x, y0 = y, r = radius, fill = color, color = color)) +
  scale_fill_manual(values = cols3) +
  scale_color_manual(values = cols3) +
  new_scale_fill() +
  new_scale_color() +
  geom_circle(data = circle_2, aes(x0 = x, y0 = y, r = radius, fill = color, color = color)) +
  scale_fill_manual(values = cols2) +
  scale_color_manual(values = cols2) +
  new_scale_fill() +
  new_scale_color() +
  geom_circle(data = circle_1, aes(x0 = x, y0 = y, r = radius, fill = color, color = color)) +
  scale_fill_manual(values = cols1) +
  scale_color_manual(values = cols1) +
  coord_fixed(xlim = c(0, 157), ylim = c(0, 86), expand = FALSE) +
  guides(color = NULL) +
  theme_void() +
  theme(legend.position = "none",
        #panel.background = element_rect(fill = "#D9D2BF"),
        plot.margin = unit(c(0, 0, 0, 0), units = "inches"))
```

cols <- as.character(circle$color)

circle %<>%
  arrange(desc(layer_order))

ggplot() +
  geom_circle(data = circle, aes(x0 = x, y0 = y, r = radius, color = color, fill = color)) +
  scale_fill_manual(values = cols) +
  scale_color_manual(values = cols) +
  coord_fixed(xlim = c(0, 157), ylim = c(0, 86), expand = FALSE) +
  guides(color = NULL) +
  theme_void() +
  theme(legend.position = "none",
        #panel.background = element_rect(fill = "#D9D2BF"),
        plot.margin = unit(c(0, 0, 0, 0), units = "inches"))
        
```{r}
id <- factor(c(1:16))

shapes <- data.frame(
  id = id,
  color = c("#90AFC7", "#234533", "#E3D2D3", "#9E7237", "#E6D54B", "#8C898A", "#0B0B0B", "#B4B76F", "#CB3121",
            "#C12B1D", "#C92B1F", "#B89D42", "#AE774C", "#B26A2D", "#744C1A", "#814819"),
  color_category = c("blue", "green", "white", "brown", "yellow", "grey", "black", "green", "red", "red", "red",
                     "yellow", "brown", "brown", "brown", "brown"),
  layer_order = c(4, 6, 5, 3, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1),
  transparency = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.5, 1, 1, 1, 1))

coords <- data.frame(
  id = rep(id, each = 3),
  x = c(36, 55.5, 90, 80, 107, 99, 74.5, 102, 88, 80, 100.5, 97, 89, 94, 92, 88.5, 96, 89, 97.5, 104.3, 103.5, 
        98, 107.5, 108.5, 93.2, 96, 93.5, 99, 97.5, 98.6, 99.2, 98, 99.5, 112, 122.5, 120, 112.5, 134, 111.5,
        112, 126.5, 113.2, 111, 124, 112.3, 109.5, 125, 110.6),
  y = c(44, 64.5, 34, 39.5, 39.5, 52.5, 35, 35, 84, 39.5, 39.5, 51, 75, 75, 79.5, 48.3, 46.5, 50, 47, 54, 55,
        45, 33, 34, 47.2, 46.5, 47.7, 48.3, 47, 48.5, 43.3, 45, 43.5, 19, 16, 28, 59, 73, 61,
        57, 33, 57.5, 51.5, 32, 52, 50.5, 27, 51)
)

triangles <- full_join(coords, shapes, by = "id") %>%
  mutate(
    color_order = row_number(),
    color = fct_reorder(color, color_order))

cols <- as.character(unique(triangles$color))

ggplot() +
  geom_polygon(data = triangles, aes(x = x, y = y, group = id, fill = color)) +
  scale_fill_manual(values = cols) +
  coord_fixed(xlim = c(0, 157), ylim = c(0, 86), expand = FALSE) +
  theme_void() +
  theme(legend.position = "none")
```

```{r}
id <- factor(c(1:55))

shapes <- data.frame(
  id = id,
  color = c("#0C0C0F", "#7A521E", "#F4E4E2", "#4F652D", "#DED5D3", "#070709", 
            # new row
            "#B4BDC7", "#09090B", "#DFD8D4", "#6D93AE", "#DBD3CA", "#0E0E11", "#D9D3BF", "#0B0B0D",
            # new row
            "#E9D5D0", "#CCCBB0", "#DFD6D1", "#E0DACC", "#40664B", "#DBD2CC", "#101014", "#E0D8D6", "#D5C6C1",
            "#D9D2C7", "#0C0C0E",
            # new row
            "#7B9248", "#E7DFDD", "#D1D4CE", "#E1A1A0", "#C9BDB3", "#111013", "#D4CCC2", "#855A20",
            "#D8D0CA", "#101414", "#D4CBC3", "#09080B", "#D5CEC9", "#141416", "#DFD9D3", "#0A0B0D",
            # other squares
            "#7B1B1C", "#E2D299", "#DA90A4", "#424242", "#050507", "#0D0C11", "#07030C", "#0C0A0F", "#1C1918", "#000000",
            # hashtag
            "#EBB2A8", "#E8E8ED", "#C54D54", "#DAD7DA"
            ),
  color_category = c("black", "brown", "white", "green", "white", "black", 
                     # new row
                     "grey", "black", "white", "blue", "white", "black", "white", "black",
                     # new row
                     "white", "white", "white", "white", "green", "white", "black", "white", "white", "white", "black",
                     # new row
                     "green", "white", "white", "pink", "white", "black", "white", "brown", "white", "black",
                     "white", "black", "white", "black", "white", "black",
                     # other squares
                     "red", "yellow", "pink", "black", "black", "black", "black", "black", "black", "black",
                     # hashtag
                     "pink", "white", "pink", "white"),
  layer_order = c(rep(1, 49), rep(2, 2), rep(1, 4)),
  transparency = c(rep(1, 55)))

coords <- data.frame(
  id = rep(id, each = 4),
  x = c(30.5, 31, 51, 50, 42, 44, 48, 46, 44, 45, 50, 48, 45, 46.5, 52.5, 50, 46.5, 47.5, 54.5, 52.5, 
        47.5, 49.5, 56, 54.5, 46, 48, 49.5, 46.5, 48, 50, 52, 49.5, 50, 52.5, 55, 52, 52.5, 54.5, 57.5, 55,
        54.5, 56, 59, 57.5,
        56, 57, 60, 59, 
        57, 58, 61.5, 60,
        58, 59, 63, 61.5,
        # new row
        46.5, 49.5, 51, 48.5,
        49.5, 52, 53.5, 51,
        52, 55, 57, 53.5,
        55, 57.5, 59, 57,
        57.5, 59, 60, 59,
        59, 60, 61.5, 60,
        60, 61.5, 62.5, 61.5,
        61.5, 63, 64, 62.5,
        63, 66, 67, 64,
        66, 68, 69, 67,
        68, 70, 70.5, 69,
        # new row
        48.5, 51, 53, 51,
        51, 53.5, 55.5, 53,
        53.5, 57, 59, 55.5,
        57, 59, 61, 59,
        59, 60, 61.5, 61,
        60, 61.5, 63, 61.5,
        61.5, 62.5, 64, 63,
        62.5, 64, 65, 64,
        64, 67, 68, 65,
        67, 69, 70, 68,
        69, 70.5, 72, 70,
        70.5, 72, 73, 72,
        72, 73.5, 74.5, 73,
        73.5, 74.5, 75.5, 74.5,
        74.5, 75.5, 76.5, 75.5,
        75.5, 77, 78, 76.5,
        # other squares
        125.5, 125.5, 130, 130,
        116, 116, 118, 118,
        100, 100, 107, 107,
        119.5, 122.5, 124, 121,
        122, 124.5, 126, 123,
        127, 129, 130, 128,
        127, 128.5, 129, 127.5,
        128, 129.5, 131, 129,
        125.3, 125.3, 130.3, 130.3,
        115.5, 115.5, 118.5, 118.5,
        # hashtag
        129, 129, 132, 132,
        129, 129, 132, 132,
        132, 132, 135, 135,
        132, 132, 135, 135
        ),
  y = c(33, 34, 23, 22, 28, 34, 30, 26, 34, 37, 33, 30, 37, 39.5, 36, 33, 39.5, 43, 38.5, 36, 
        43, 47.5, 41, 38.5, 26, 30, 28.5, 25.5, 30, 33, 31.5, 28.5, 33, 36, 35, 31.5, 36, 38.5, 37, 35,
        38.5, 41, 38.5, 37,
        41, 43, 40, 38.5,
        43, 44, 41, 40,
        44, 46.5, 42.5, 41,
        # new row
        25.5, 28.5, 27, 24.5,
        28.5, 31.5, 30, 27,
        31.5, 35, 33.5, 30,
        35, 37, 36, 33.5,
        37, 38.5, 37, 36,
        38.5, 40, 38.5, 37,
        40, 41, 40, 38.5,
        41, 42.5, 41.5, 40,
        42.5, 45.5, 44.5, 41.5,
        45.5, 47.5, 47, 44.5,
        47.5, 49.5, 49, 47,
        # new row
        24.5, 27, 25.5, 23,
        27, 30, 28.5, 25.5,
        30, 33.5, 33, 28.5,
        33.5, 36, 35, 33,
        36, 37, 35.5, 35,
        37, 38.5, 37, 35.5,
        38.5, 40, 38.5, 37,
        40, 41.5, 40, 38.5,
        41.5, 44.5, 43, 40,
        44.5, 47, 46, 43,
        47, 49, 48, 46,
        49, 50, 49.5, 48,
        50, 52, 51, 49.5,
        52, 53, 52, 51,
        53, 54, 53.5, 52,
        54, 56, 55, 53.5,
        # other squares
        7, 11, 11, 7,
        79, 81, 81, 79,
        60.5, 67, 67, 60.5,
        61.5, 63.5, 60.5, 58.5,
        58, 59.5, 57, 55.5,
        73.5, 74.5, 72.5, 71.5,
        68.5, 69.5, 68, 67,
        66, 67, 65, 64,
        6.8, 11.2, 11.2, 6.8,
        78.5, 81.5, 81.5, 78.5,
        # hashtag
        47, 50, 50, 47,
        50, 53, 53, 50,
        50, 53, 53, 50,
        47, 50, 50, 47
        )
)

quads <- full_join(coords, shapes, by = "id") %>%
  mutate(
    color_order = row_number(),
    color = fct_reorder(color, color_order))

cols <- as.character(unique(quads$color))

ggplot() +
  geom_polygon(data = quads, aes(x = x, y = y, group = id, fill = color)) +
  scale_fill_manual(values = cols) +
  coord_fixed(xlim = c(0, 157), ylim = c(0, 86), expand = FALSE) +
  theme_void() +
  theme(legend.position = "none")
```

```{r}
lines <- tribble(~grouping, ~x, ~xend, ~y, ~yend, ~thickness, ~layer_order,
                 1, 28, 72, 44, 57, 1, 1,
                 2, 46, 68, 8, 22, 1, 1,
                 2, 50, 66, 3, 17.7, 1, 1,
                 3, 65, 78, 16, 15.6, 1, 1,
                 3, 65, 77, 18.4, 18, 1, 1,
                 4, 68, 88, 10, 84, 1.5, 1,
                 4, 88, 111, 84, 6, 1.5, 2,
                 5, 37, 55.5, 45, 64.5, 1, 1,
                 5, 55.5, 90, 64.5, 34, 1, 1,
                 6, 42, 49.5, 28, 47, 1, 1,
                 6, 49.5, 62, 47, 36, 1, 1,
                 6, 46, 59, 26, 46, 1, 1,
                 6, 59, 65, 46, 40, 1, 1,
                 6, 46.5, 70, 25.5, 49.5, 1, 1,
                 6, 70, 72, 49.5, 48, 1, 1,
                 6, 49, 77, 24, 56, 1, 1,
                 6, 77, 78, 56, 55, 1, 1,
                 6, 44, 53, 34, 25, 1, 1,
                 6, 45.5, 55.5, 37, 28.5, 1, 1,
                 6, 46.5, 59, 39.5, 33, 1, 1,
                 6, 48, 61, 43, 35, 1, 1,
                 6, 57, 63, 43, 37, 1, 1,
                 6, 58, 64, 44, 39, 1, 1,
                 6, 66, 68, 45.5, 43, 1, 1,
                 6, 68, 70, 48, 46, 1, 1,
                 6, 72, 73, 50, 49, 1, 1,
                 6, 74, 75, 52, 51, 1, 1,
                 6, 75, 76, 53, 52, 1, 1,
                 6, 76, 77, 54.5, 53.5, 1, 1,
                 6, 51, 78, 23, 55, 1, 1, 
                 7, 55.5, 120, 28.5, 27.6, 1, 1, 
                 # new page
                 8, 87.5, 87.5, 0, 32, 1, 1, 
                 9, 85, 99, 12, 27, 1, 1, 
                 10, 85, 99, 12, 27, 1, 1, 
                 10, 84.5, 98.5, 12.5, 27.5, 1, 1, 
                 10, 84, 98, 13, 28, 1, 1, 
                 11, 83.5, 98, 19.5, 33.5, 1, 1, 
                 11, 83, 97.5, 20, 34, 1, 1, 
                 11, 82.5, 97, 20.5, 34.5, 1, 1, 
                 12, 104, 118.5, 10.5, 11, 1, 1, 
                 12, 97, 117.5, 20, 20, 1, 1, 
                 13, 120, 98, 15, 36, 2, 1,
                 14, 132, 107, 36, 44.5, 3, 1,
                 15, 128, 131.5, 8.5, 8.5, 1.5, 1,
                 15, 128, 131.5, 9.1, 9.1, 1, 1,
                 16, 52, 86, 28, 38, 3, 1,
                 17, 53.5, 90, 33, 40, 3, 1,
                 # return to upper left
                 18, 55.5, 55.5, 56, 78, 1, 1,
                 18, 53, 61, 68.6, 68.9, 1, 1,
                 18, 52, 60, 70, 70.4, 1, 1,
                 18, 51, 66, 77, 70, 1, 1,
                 19, 76, 98, 78, 64, 1, 1,
                 19, 77, 98, 73, 64, 1, 1,
                 20, 78, 91, 54.5, 60.5, 1, 1,
                 20, 78.5, 91.5, 54, 60, 1, 1,
                 21, 77, 98, 51, 62, 1, 1, # needs orange right above
                 21, 88, 101.5, 52, 64, 1, 1,
                 21, 84.5, 102.5, 46.5, 63.5, 1, 1,
                 21, 91.5, 101.5, 51, 58.5, 1, 1, #needs yellow right below
                 22, 99.5, 99.5, 70, 86, 1, 1,
                 # top right checkerboard cluster
                 23, 102.5, 142, 65, 86, 1, 1,
                 23, 104, 147, 63.5, 86, 1, 1,
                 23, 105, 156, 62, 86, 1, 1,
                 23, 106, 124, 60, 69.5, 1, 1,
                 23, 104, 134, 56, 73, 1, 1,
                 23, 105, 109.5, 54.5, 57, 1, 1,
                 23, 111.5, 134, 58.5, 73, 1, 1,
                 23, 106, 110, 53, 55.5, 1, 1,
                 23, 112, 122.5, 57, 63.5, 1, 1,
                 23, 107, 112, 51, 54, 1, 1,
                 23, 108, 113, 49.5, 52.5, 1, 1,
                 23, 104, 137, 56, 4, 1, 1,
                 23, 105.5, 125, 57, 26.5, 1, 1,
                 23, 108, 125, 56, 26.5, 1, 1,
                 23, 102.5, 124, 65, 32, 1, 1,
                 23, 104.5, 124, 66.3, 32, 1, 1,
                 23, 106, 126.5, 67, 33.5, 1, 1,
                 23, 108, 126.5, 68, 33.5, 1, 1,
                 23, 109.5, 113, 69, 64, 1, 1,
                 23, 111.5, 116.5, 70, 65.5, 1, 1,
                 23, 119, 120, 74, 72, 1, 1,
                 23, 121, 122, 75, 73, 1, 1,
                 23, 129, 130, 79, 77.5, 1, 1,
                 23, 131.5, 80.5, 132.5, 78.5, 1, 1,
                 23, 138.5, 140, 84, 82.5, 1, 1,
                 23, 141, 142, 85.5, 83.5, 1, 1
) %>%
  mutate(thickness = thickness / 10)

horizontal_lines <- tibble(grouping = c(rep(0, 6), rep(22, 5)),
       x = c(rep(124, 3), seq(129, 135, 3), rep(98, 3), rep(97.5, 2)),
       xend = c(rep(139, 3), seq(129, 135, 3), rep(101.7, 5)),
       y = c(seq(47, 53, 3), rep(42, 3), seq(71.1, 71.9, length.out = 3), seq(82.5, 82.9, length.out = 2)),
       yend = c(seq(47, 53, 3), rep(57, 3), seq(71.2, 72, length.out = 3), seq(82.6, 83, length.out = 2)),
       thickness = c(rep(1, 6), rep(0.5, 5)),
       layer_order = rep(1, 11))

lines <- bind_rows(lines, horizontal_lines)

ggplot() +
  #geom_polygon(data = triangles, aes(x = x, y = y, group = id, fill = color)) +
  geom_polygon(data = quads, aes(x = x, y = y, group = id, fill = color)) +
  scale_fill_manual(values = cols) +
  new_scale_fill() +
  new_scale_color() +
  #geom_circle(data = circles, aes(x0 = x, y0 = y, r = radius, fill = color, color = color)) +
  scale_fill_manual(values = circle_cols) +
  scale_color_manual(values = circle_cols) +
  geom_segment(data = lines, aes(x = x, xend = xend, y = y, yend = yend)) +
  coord_fixed(xlim = c(0, 157), ylim = c(0, 86), expand = FALSE) +
  theme_void() +
  theme(legend.position = "none")
```


References
for ggcircle
https://datavizpyr.com/annotate-a-plot-with-circle-ggplot2/
multiple manual color scales
https://pythonawesome.com/multiple-fill-and-color-scales-in-ggplot2/
